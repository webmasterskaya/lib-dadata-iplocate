# Joomla.Library - Город по IP-адресу через DaData

Библиотека Joomla, позаоляет определить город и другую информацию о местоположении пользователя, по его IP. Работает
через сервис [DaData](https://dadata.ru/api/iplocate/)

> Внимание! Работает только для IP-адрессов России

✔️ Определяет IP-адрес клиента.

✔️ Определяет город по IP-адресу в России.

✔️ Поддерживает как IPv4, так и IPv6 адреса.

✔️ Возвращает детальную информацию о городе, в том числе почтовый индекс.

## Установка

Скачать последнюю версию библиотеки и установить, как обычное расширение Joomla!

## Использование

⚠ Перед использованием библиотеки, в своём коде, нужно зарегистрировать пространство имён

```PHP
JLoader::registerNamespace('DaData', JPATH_LIBRARIES.'/src', false, false, 'psr4');
```

### Определить IP адрес клиента

```PHP
DaData\IPLocate\IPLocate::getClientIp();
```

Метод возвращает строку с IP адресом клиента

### Определить местоположение клиента по IP

```PHP
DaData\IPLocate\IPLocate::address($token, $ip);
```

| Параметр | Тип | Обязательный | Описание |
| ------ | ------ | ------ | ------ |
| $token | string | Да | API-ключ сервиса DaData.ru |
| $ip | string | Нет | IP-дрес, местоположение которого нужно вычеслить |

> Если IP адрес не передавать, то библиотек попытается самостоятельно его определить, используя метод `getClientIp()`

Метод возвращает массив данных, о место опложении IP адреса или `NULL`, если не удалось определить местоположение.

Описание полей массива можно прочитать на сайте [DaData](https://dadata.ru/api/iplocate/#response)

## Как получить токен DaData?

Для того, чтобы получить токен, нужно [зарегистрироваться](https://dadata.ru/api/iplocate/#registration_popup) на
DaData.ru и подтвердите почту. После регистрации вы сможете сгенерировать токен
в [Личном кабинете](https://dadata.ru/profile/#info). Если вы уже зарегистрированы, то токен можно найти там же.
